program: train.py
method: bayes
metric:
  name: val/worst_class_recall
  goal: maximize
early_terminate:
  type: hyperband
  min_iter: 15
  eta: 3
  s: 2

parameters:
  model_name:
    value: 'swin_base_patch4_window12_384'
  
  image_size:
    value: 384
  
  # Learning rate - extended upper range based on top runs
  learning_rate:
    min: 0.00009
    max: 0.00012
  
  weight_decay:
    min: 0.00020
    max: 0.00035
  
  batch_size:
    value: 32
  
  epochs:
    value: 50
  
  warmup_epochs:
    value: 12
  
  scheduler:
    value: 'cosine'
  
  # Loss functions: Focus on top performers (poly & asymmetric)
  loss_function:
    values: ['asymmetric', 'poly']
  
  # Focal gamma - lower values perform better
  focal_gamma:
    min: 1.3
    max: 1.6
  
  label_smoothing:
    value: 0.12
  
  # CLASS WEIGHT BOOST - Keep current range (no strong correlation)
  class_weight_boost:
    min: 1.8
    max: 2.5
  
  # LAMBDA_WORST - Strong negative correlation; focus on lower values
  lambda_worst:
    min: 0.20
    max: 0.35
  
  # Poly epsilon for PolyLoss (higher values show slight improvement)
  poly_epsilon:
    min: 1.8
    max: 2.4
  
  # Augmentation - proven values
  mixup_alpha:
    values: [0.08, 0.10, 0.12]
  
  cutmix_alpha:
    min: 0.8
    max: 1.0
  
  mixup_prob:
    value: 0.4
  
  color_jitter_brightness:
    value: 0.2
  
  color_jitter_contrast:
    value: 0.2
  
  color_jitter_saturation:
    value: 0.2
  
  dropout_rate:
    min: 0.28
    max: 0.40
  
  stochastic_depth:
    value: 0.20
# OPTIMIZATION STRATEGY (UPDATED):
# - Metric: val/worst_class_recall (targeting Erythema class bottleneck)
# - Key Findings: Lower lambda_worst, lower weight_decay, lower focal_gamma perform better
# - Dropout: Higher values beneficial (0.3+)
# - Current Best: ~0.90 balanced accuracy but Erythema stuck at 0.667 recall
# - Goal: Break through Erythema bottleneck while maintaining overall performance
# - Expected runs: ~30-50 for convergencerecall > 0.70
# - Expected runs: ~40-60 for convergence
