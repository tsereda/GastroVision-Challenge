program: train.py
method: bayes
metric:
  name: val/balanced_accuracy
  goal: maximize
early_terminate:
  type: hyperband
  min_iter: 12
  eta: 3
  s: 2

parameters:
  model_name:
    value: 'swin_base_patch4_window7_224'
  
  image_size:
    value: 224  # Lock to 224 - your top runs used this
  
  learning_rate:
    values: [0.0001, 0.00015, 0.0002]  # Narrow around 0.0001 (your winner)
  
  weight_decay:
    values: [0.0001, 0.0002, 0.0003]
  
  batch_size:
    value: 32  # More stable than 48
  
  epochs:
    value: 40  # Increase from 20
  
  warmup_epochs:
    values: [8, 10, 12]
  
  scheduler:
    value: 'cosine'  # Simpler is better
  
  loss_function:
    value: 'focal_weighted'
  
  focal_gamma:
    values: [1, 1.3, 1.4, 1.5, 1.6, 1.7]  # CRITICAL: Your 77.8% run used ~1.5
  
  label_smoothing:
    values: [0.08, 0.10, 0.12]
  
  mixup_alpha:
    values: [0.1, 0.15, 0.2]
  
  cutmix_alpha:
    values: [0.8, 1.0]
  
  mixup_prob:
    value: 0.4
  
  color_jitter_brightness:
    value: 0.2
  
  color_jitter_contrast:
    value: 0.2
  
  color_jitter_saturation:
    value: 0.2
  
  dropout_rate:
    values: [0.2, 0.3]
  
  stochastic_depth:
    values: [0.15, 0.2]
  
  # NEW: Boost class weights for minority classes
  class_weight_boost:
    values: [1.5, 2.0, 2.5, 3.0]
